<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="1251px" preserveAspectRatio="none" style="width:554px;height:1251px;" version="1.1" viewBox="0 0 554 1251" width="554px" zoomAndPan="magnify"><defs><filter height="300%" id="fdpbdvxdwuu94" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><rect fill="#DDDDDD" height="1236.5185" style="stroke: #A80036; stroke-width: 1.0;" width="122" x="187" y="4"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="49" x="223.5" y="16.792">Backend</text><rect fill="#DDDDDD" height="1236.5185" style="stroke: #A80036; stroke-width: 1.0;" width="151" x="380" y="4"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="53" x="429" y="16.792">Keycloak</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="510.1844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="220" y="532.7131"/><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="30.341" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="413" y="734.1233"/><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="217.7512" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="489.5" y="794.8053"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="30" x2="30" y1="87.9389" y2="1152.9205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="93" x2="93" y1="87.9389" y2="1152.9205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="152" x2="152" y1="87.9389" y2="1152.9205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="225" x2="225" y1="87.9389" y2="1152.9205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="287" x2="287" y1="87.9389" y2="1152.9205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="418" x2="418" y1="87.9389" y2="1152.9205"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 5.0,5.0;" x1="494" x2="494" y1="87.9389" y2="1152.9205"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="8" y="84.117">Beavis</text><ellipse cx="30" cy="13.341" fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30,21.341 L30,48.341 M17,29.341 L43,29.341 M30,48.341 L17,63.341 M30,48.341 L43,63.341 " fill="none" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="38" x="8" y="1165.6965">Beavis</text><ellipse cx="30" cy="1179.5185" fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M30,1187.5185 L30,1214.5185 M17,1195.5185 L43,1195.5185 M30,1214.5185 L17,1229.5185 M30,1214.5185 L43,1229.5185 " fill="none" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="62" y="84.117">Butthead</text><ellipse cx="93" cy="13.341" fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93,21.341 L93,48.341 M80,29.341 L106,29.341 M93,48.341 L80,63.341 M93,48.341 L106,63.341 " fill="none" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="56" x="62" y="1165.6965">Butthead</text><ellipse cx="93" cy="1179.5185" fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M93,1187.5185 L93,1214.5185 M80,1195.5185 L106,1195.5185 M93,1214.5185 L80,1229.5185 M93,1214.5185 L106,1229.5185 " fill="none" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="134" y="84.117">Daria</text><ellipse cx="152.5" cy="13.341" fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M152.5,21.341 L152.5,48.341 M139.5,29.341 L165.5,29.341 M152.5,48.341 L139.5,63.341 M152.5,48.341 L165.5,63.341 " fill="none" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="31" x="134" y="1165.6965">Daria</text><ellipse cx="152.5" cy="1179.5185" fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" rx="8" ry="8" style="stroke: #A80036; stroke-width: 2.0;"/><path d="M152.5,1187.5185 L152.5,1214.5185 M139.5,1195.5185 L165.5,1195.5185 M152.5,1214.5185 L139.5,1229.5185 M152.5,1214.5185 L165.5,1229.5185 " fill="none" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 2.0;"/><rect fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" height="31.5979" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="201" y="51.341"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="208" y="72.117">REST</text><rect fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" height="31.5979" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="201" y="1151.9205"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="208" y="1172.6965">REST</text><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="17" x="275.5" y="84.117">DB</text><path d="M269,34.341 C269,24.341 287,24.341 287,24.341 C287,24.341 305,24.341 305,34.341 L305,60.341 C305,70.341 287,70.341 287,70.341 C287,70.341 269,70.341 269,60.341 L269,34.341 " fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M269,34.341 C269,44.341 287,44.341 287,44.341 C287,44.341 305,44.341 305,34.341 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="17" x="275.5" y="1165.6965">DB</text><path d="M269,1179.5185 C269,1169.5185 287,1169.5185 287,1169.5185 C287,1169.5185 305,1169.5185 305,1179.5185 L305,1205.5185 C305,1215.5185 287,1215.5185 287,1215.5185 C287,1215.5185 269,1215.5185 269,1205.5185 L269,1179.5185 " fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" style="stroke: #000000; stroke-width: 1.5;"/><path d="M269,1179.5185 C269,1189.5185 287,1189.5185 287,1189.5185 C287,1189.5185 305,1189.5185 305,1179.5185 " fill="none" style="stroke: #000000; stroke-width: 1.5;"/><rect fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" height="31.5979" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="394" y="51.341"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="401" y="72.117">OIDC</text><rect fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" height="31.5979" style="stroke: #A80036; stroke-width: 1.5;" width="44" x="394" y="1151.9205"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="30" x="401" y="1172.6965">OIDC</text><rect fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" height="31.5979" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="472" y="51.341"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="479" y="72.117">UMA</text><rect fill="#FEFECE" filter="url(#fdpbdvxdwuu94)" height="31.5979" style="stroke: #A80036; stroke-width: 1.5;" width="41" x="472" y="1151.9205"/><text fill="#000000" font-family="Source Sans Pro" font-size="14" lengthAdjust="spacingAndGlyphs" textLength="27" x="479" y="1172.6965">UMA</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="510.1844" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="220" y="532.7131"/><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="30.341" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="413" y="734.1233"/><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="217.7512" style="stroke: #A80036; stroke-width: 1.0;" width="10" x="489.5" y="794.8053"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="539" x="3" y="119.1094"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="119.1094" y2="119.1094"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="122.1094" y2="122.1094"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="24.341" style="stroke: #000000; stroke-width: 2.0;" width="91" x="227" y="107.9389"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="74" x="233" y="124.7309">Authenticate</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="42.682" style="stroke: #000000; stroke-width: 2.0;" width="446" x="5" y="142.28"/><polygon fill="#EEEEEE" points="5,142.28,66,142.28,66,150.28,56,160.28,5,160.28,5,142.28" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="18" y="157.072">ref</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="196" y="177.072">authenticate</text><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="539" x="3" y="211.1325"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="211.1325" y2="211.1325"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="214.1325" y2="214.1325"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="24.341" style="stroke: #000000; stroke-width: 2.0;" width="112" x="216.5" y="199.962"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="95" x="222.5" y="216.754">Create Resource</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="42.682" style="stroke: #000000; stroke-width: 2.0;" width="521" x="5" y="234.303"/><polygon fill="#EEEEEE" points="5,234.303,66,234.303,66,242.303,56,252.303,5,252.303,5,234.303" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="18" y="249.095">ref</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="84" x="225.5" y="269.095">create resource</text><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="539" x="3" y="303.1555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="303.1555" y2="303.1555"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="306.1555" y2="306.1555"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="24.341" style="stroke: #000000; stroke-width: 2.0;" width="106" x="219.5" y="291.985"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="89" x="225.5" y="308.777">Share Resource</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="42.682" style="stroke: #000000; stroke-width: 2.0;" width="521" x="5" y="326.326"/><polygon fill="#EEEEEE" points="5,326.326,66,326.326,66,334.326,56,344.326,5,344.326,5,326.326" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="18" y="341.1181">ref</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="206" x="123" y="361.1181">share resource (user: Butthead, scope:</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="76" x="332" y="361.1181">"stuff:share"</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="408" y="361.1181">)</text><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="539" x="3" y="395.1786"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="395.1786" y2="395.1786"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="398.1786" y2="398.1786"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="24.341" style="stroke: #000000; stroke-width: 2.0;" width="109" x="218" y="384.0081"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="92" x="224" y="400.8001">Authenticate (2)</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="42.682" style="stroke: #000000; stroke-width: 2.0;" width="392" x="59" y="418.3491"/><polygon fill="#EEEEEE" points="59,418.3491,120,418.3491,120,426.3491,110,436.3491,59,436.3491,59,418.3491" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="72" y="433.1411">ref</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="68" x="223" y="453.1411">authenticate</text><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="539" x="3" y="487.2016"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="487.2016" y2="487.2016"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="490.2016" y2="490.2016"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="24.341" style="stroke: #000000; stroke-width: 2.0;" width="124" x="210.5" y="476.0311"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="107" x="216.5" y="492.8231">Share Resource (2)</text><polygon fill="#A80036" points="208,528.7131,218,532.7131,208,536.7131,212,532.7131" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="93" x2="214" y1="532.7131" y2="532.7131"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="100" y="527.1641">[18']</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="54" x="130" y="527.1641">&lt;&lt;share&gt;&gt;</text><path d="M98,545.7131 L98,702.7131 L288,702.7131 L288,555.7131 L278,545.7131 L98,545.7131 " fill="#FBFB77" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M278,545.7131 L278,555.7131 L288,555.7131 L278,545.7131 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="127" x="104" y="563.5052">POST /stuff/${ID}/share</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="107" y="579.8462"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="150" x="104" y="596.1872">Authorization: Bearer ${rpt}</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="104" y="612.5282">Content-Type: application/json'</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="104" y="628.8692">{</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="146" x="116" y="645.2102">"requester": "123-456-789",</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="98" x="116" y="661.5512">"requesterName":</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="44" x="217" y="661.5512">"daria"</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="3" x="261" y="661.5512">,</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="58" x="116" y="677.8923">"scopes": [</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="177" y="677.8923">"stuff:read"</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="250" y="677.8923">]</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="104" y="694.2333">}</text><polygon fill="#A80036" points="401,730.1233,411,734.1233,401,738.1233,405,734.1233" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="230" x2="407" y1="734.1233" y2="734.1233"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="237" y="728.5743">[19']</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="134" x="267" y="728.5743">&lt;&lt;impersonate(owner)&gt;&gt;</text><polygon fill="#A80036" points="241,760.4643,231,764.4643,241,768.4643,237,764.4643" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="235" x2="417" y1="764.4643" y2="764.4643"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="247" y="758.9153">[20']</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="113" x="277" y="758.9153">owner_access_token</text><polygon fill="#A80036" points="477.5,790.8053,487.5,794.8053,477.5,798.8053,481.5,794.8053" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0;" x1="230" x2="483.5" y1="794.8053" y2="794.8053"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="237" y="789.2563">[21']</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="152" x="267" y="789.2563">&lt;&lt;create permission ticket&gt;&gt;</text><path d="M235,807.8053 L235,980.8053 L530,980.8053 L530,817.8053 L520,807.8053 L235,807.8053 " fill="#FBFB77" filter="url(#fdpbdvxdwuu94)" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M520,807.8053 L520,817.8053 L530,817.8053 L520,807.8053 " fill="#FBFB77" style="stroke: #A80036; stroke-width: 1.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="274" x="241" y="825.5973">POST ${realm}/authz/protection/permission/ticket</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="0" x="244" y="841.9384"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="247" x="241" y="858.2794">Authorization: Bearer ${owner_access_token}</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="169" x="241" y="874.6204">Content-Type: application/json'</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="241" y="890.9614">{</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="158" x="247" y="907.3024">"resource": "${resource_id}",</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="138" x="247" y="923.6434">"requester": "${user_id}",</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="86" x="247" y="939.9844">"granted": true,</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="78" x="247" y="956.3255">"scopeName":</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="70" x="328" y="956.3255">"stuff:read"</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="4" x="241" y="972.6665">}</text><polygon fill="#A80036" points="241,1008.5565,231,1012.5565,241,1016.5565,237,1012.5565" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="235" x2="493.5" y1="1012.5565" y2="1012.5565"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="247" y="1007.0075">[22']</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="277" y="1007.0075">201 Created</text><polygon fill="#A80036" points="104,1038.8975,94,1042.8975,104,1046.8975,100,1042.8975" style="stroke: #A80036; stroke-width: 1.0;"/><line style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 2.0,2.0;" x1="98" x2="224" y1="1042.8975" y2="1042.8975"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="26" x="110" y="1037.3485">[23']</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="63" x="140" y="1037.3485">201 Created</text><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="3" style="stroke: #EEEEEE; stroke-width: 1.0;" width="539" x="3" y="1072.068"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="1072.068" y2="1072.068"/><line style="stroke: #000000; stroke-width: 1.0;" x1="3" x2="542" y1="1075.068" y2="1075.068"/><rect fill="#EEEEEE" filter="url(#fdpbdvxdwuu94)" height="24.341" style="stroke: #000000; stroke-width: 2.0;" width="111" x="217" y="1060.8975"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="94" x="223" y="1077.6895">Access Resource</text><rect fill="#FFFFFF" filter="url(#fdpbdvxdwuu94)" height="42.682" style="stroke: #000000; stroke-width: 2.0;" width="173" x="131" y="1095.2385"/><polygon fill="#EEEEEE" points="131,1095.2385,192,1095.2385,192,1103.2385,182,1113.2385,131,1113.2385,131,1095.2385" style="stroke: #000000; stroke-width: 2.0;"/><text fill="#000000" font-family="Source Sans Pro" font-size="13" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="16" x="144" y="1110.0305">ref</text><text fill="#000000" font-family="Source Sans Pro" font-size="13" lengthAdjust="spacingAndGlyphs" textLength="85" x="177" y="1130.0305">access resource</text><!--
@startuml

skinparam backgroundColor #FFFFFF
skinparam defaultFontName "Source Sans Pro"
skinparam ParticipantPadding 10
skinparam BoxPadding 10

actor Beavis
actor Butthead
actor Daria

box "Backend"
    participant REST
    database DB
end box

box "Keycloak"
    participant OIDC
    participant UMA
end box

autoactivate on

== Authenticate ==
ref over Beavis, OIDC: authenticate

== Create Resource ==
ref over Beavis, UMA: create resource

== Share Resource ==
ref over Beavis, UMA: share resource (user: Butthead, scope: <b>"stuff:share"</b>)

== Authenticate (2) ==
ref over Butthead, OIDC: authenticate

== Share Resource (2) ==
autonumber 18 "<b>[##'']</b>"
Butthead -> REST: <<share>>
note right of Butthead
    POST /stuff/${ID}/share

    Authorization: Bearer ${rpt}
    Content-Type: application/json'
    {
        "requester": "123-456-789",
        "requesterName": <b>"daria"</b>,
        "scopes": [ <b>"stuff:read"</b> ]
    }
end note
REST -> OIDC: <<impersonate(owner)>>
return owner_access_token
REST -> UMA: <<create permission ticket>>
note right of REST
    POST ${realm}/authz/protection/permission/ticket

    Authorization: Bearer ${owner_access_token}
    Content-Type: application/json'
    {
      "resource": "${resource_id}",
      "requester": "${user_id}",
      "granted": true,
      "scopeName": <b>"stuff:read"</b>
    }
end note
return 201 Created
REST - -> Butthead: 201 Created

== Access Resource ==
ref over Daria, DB: access resource

@enduml

PlantUML version 1.2019.08(Sat Jul 13 22:25:14 MSK 2019)
(GPL source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_212-b04
Operating System: Linux
OS Version: 5.1.14-desktop-1.mga7
Default Encoding: UTF-8
Language: ru
Country: RU
--></g></svg>